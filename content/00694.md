---
title: LegacyãªJavaã‚¢ãƒ—ãƒªã‚’Tanzu Application Platformã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã¾ã§ã®ãƒ¡ãƒ¢
tags: ["Kubernetes", "Cartographer", "Java", "Tanzu", "TAP", "Service Binding"]
categories: ["Dev", "CaaS", "Kubernetes", "TAP"]
---

ä»¥ä¸‹ã®Stackã‚’ä½¿ç”¨ã—ãŸãƒ¬ã‚¬ã‚·ãƒ¼ãªJavaã‚¢ãƒ—ãƒªã‚’Tanzu Application Platform (TAP) 1.7ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã¿ã¾ã™ã€‚

* Apache Struts 1.2.x
* iBatis 2.3.x
* Spring Framework 3.2.x
* Apache Ant

TAPã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯[ã“ã¡ã‚‰](/entries/778)ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**ç›®æ¬¡**
<!-- toc -->

### ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

ãƒ¬ã‚¬ã‚·ãƒ¼ãªã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã¯[ã“ã¡ã‚‰](https://ftp.iij.ad.jp/pub/osdn.jp/terasoluna/66350/terasoluna-server4jweb-toursample_2.0.6.2.zip)ã‹ã‚‰ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

```
wget https://ftp.iij.ad.jp/pub/osdn.jp/terasoluna/66350/terasoluna-server4jweb-toursample_2.0.6.2.zip
unzip terasoluna-server4jweb-toursample_2.0.6.2.zip
cd terasoluna-server4jweb-toursample_2.0.6.2
unzip toursample-javaweb.zip
cd toursample-javaweb
```

### ã‚µãƒ³ãƒ—ãƒ«ã‚¢ãƒ—ãƒªã®ãƒ“ãƒ«ãƒ‰

Mavenã‚„Gradleã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€Cloud Native Buildpacksã‚’ä½¿ç”¨ã—ã¦TAPä¸Šã§ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ãƒ“ãƒ«ãƒ‰ã‹ã‚‰è¡Œãˆã¾ã™ãŒã€
Antã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ã®ã§ã€äº‹å‰ã«warã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ã€warã‚’TAPã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

TAPã§åˆ©ç”¨ã§ãã‚‹å†æ—§ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã‚ã‚‹Java 8ã§ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚antã‚‚ä¹…ã€…ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚

```
brew install ant
```

`ant/build.xml`ã‚’è¦‹ã‚‹ã¨TomcatãŒãƒ“ãƒ«ãƒ‰ã«å¿…è¦ãªãŸã‚ã€Tomcatã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¾ã™ã€‚
ã‚µãƒ³ãƒ—ãƒ«ã§Tomcat 6ãŒä½¿ç”¨ã•ã‚Œã¦ã„ã¾ã—ãŸãŒã€ã“ã“ã§ã¯Tomcat 9ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚
Tomcat 10ä»¥é™ã§ã¯Servlet APIã®packageåãŒå¤‰ã‚ã£ã¦ã„ã‚‹ã®ã§ä½¿ç”¨ã§ãã¾ã›ã‚“ã€‚

```
wget https://dlcdn.apache.org/tomcat/tomcat-9/v9.0.84/bin/apache-tomcat-9.0.84.zip
unzip apache-tomcat-9.0.84.zip -d /opt 
```

`ant/build.properties`ã®`webapsvr.home`ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«å¤‰ãˆã¾ã™ã€‚ã¾ãŸwarã®ãƒ•ã‚¡ã‚¤ãƒ«åã‚’`ROOT.war`ã«ãªã‚‹ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚

```
cat <<'EOF' > ant/build.properties
# Keep
source.dir=./sources
web.inf.dir=./webapps/WEB-INF
lib.dir=./webapps/WEB-INF/lib
zip.dir=./terasoluna/src

## Change according to your tomcat env
webapsvr.home=/opt/apache-tomcat-9.0.84
webapsvr.lib.dir=${webapsvr.home}/lib
deploy.dir=${webapsvr.home}/webapps

## Change
context.name=ROOT
EOF
```

ãƒ­ã‚°ã®å‡ºåŠ›å…ˆã‚’æ¨™æº–å‡ºåŠ›ã«ã™ã‚‹ãŸã‚ã«`sources/log4j.properties`ã‚’æ¬¡ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚


```
cat <<EOF > sources/log4j.properties
# Keep
log4j.rootCategory=INFO, consoleLog, logfile
log4j.category.jp.terasoluna=INFO
log4j.category.org.springframework=INFO
log4j.category.org.apache.struts=INFO

log4j.appender.consoleLog=org.apache.log4j.ConsoleAppender
log4j.appender.consoleLog.Target = System.out
log4j.appender.consoleLog.layout = org.apache.log4j.PatternLayout
log4j.appender.consoleLog.layout.ConversionPattern=[%d{yyyy/MM/dd HH:mm:ss}][%p][%C{1}] %m%n

# Remove
# log4j.appender.logfile=...
EOF
```

ã“ã‚Œã§antã§ãƒ“ãƒ«ãƒ‰ã—ã¾ã™ã€‚Java 8ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚

```
ant -f ant/build.xml
```


ãƒ“ãƒ«ãƒ‰ã§ãã¾ã—ãŸã€‚
```
Buildfile: /Users/toshiaki/blog/legacy/terasoluna-server4jweb-toursample_2.0.6.2/toursample-javaweb/ant/build.xml

clean:
   [delete] Deleting: /opt/apache-tomcat-9.0.84/webapps/ROOT.war

compile:
    [javac] /Users/toshiaki/blog/legacy/terasoluna-server4jweb-toursample_2.0.6.2/toursample-javaweb/ant/build.xml:69: warning: 'includeantruntime' was not set, defaulting to build.sysclasspath=last; set to false for repeatable builds
    [javac] Compiling 97 source files to /Users/toshiaki/blog/legacy/terasoluna-server4jweb-toursample_2.0.6.2/toursample-javaweb/webapps/WEB-INF/classes
     [copy] Copying 10 files to /Users/toshiaki/blog/legacy/terasoluna-server4jweb-toursample_2.0.6.2/toursample-javaweb/webapps/WEB-INF/classes

native2ascii:
[native2ascii] Converting 16 files from /Users/toshiaki/blog/legacy/terasoluna-server4jweb-toursample_2.0.6.2/toursample-javaweb/sources to /Users/toshiaki/blog/legacy/terasoluna-server4jweb-toursample_2.0.6.2/toursample-javaweb/webapps/WEB-INF/classes

build:

deploy:
      [jar] Building jar: /Users/toshiaki/blog/legacy/terasoluna-server4jweb-toursample_2.0.6.2/toursample-javaweb/ROOT.war
     [copy] Copying 1 file to /opt/apache-tomcat-9.0.84/webapps
   [delete] Deleting: /Users/toshiaki/blog/legacy/terasoluna-server4jweb-toursample_2.0.6.2/toursample-javaweb/ROOT.war

BUILD SUCCESSFUL
Total time: 1 second
```

### Flywayã®å°å…¥

DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’æ‰‹å‹•ã§è¡Œã„ãŸããªã„ã®ã§Flywayã‚’å°å…¥ã—ã¾ã™ã€‚
ã¨è¨€ã£ã¦ã‚‚ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«ã¯æ‰‹ã‚’å…¥ã‚ŒãŸããªã„ã®ã§ã€ã‚¢ãƒ—ãƒªã®èµ·å‹•å‰ã«ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§å®Ÿè¡Œã™ã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```
wget https://repo1.maven.org/maven2/org/flywaydb/flyway-commandline/5.2.4/flyway-commandline-5.2.4-linux-x64.tar.gz
tar xzvf flyway-commandline-5.2.4-linux-x64.tar.gz
mv flyway-5.2.4/ flyway
```

SQLã®æ–‡å­—ã‚³ãƒ¼ãƒ‰ãŒSHIFT_JISX0213ãªã®ã§UTF-8ã«å¤‰æ›ã—ã¡ã‚ƒã„ã¾ã™ã€‚å¤‰æ›å¾Œã®ãƒ•ã‚¡ã‚¤ãƒ«åã¯Flywayã®å‘½åè¦å‰‡ã«åˆã‚ã›ã¾ã™ã€‚

```
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/create_all_sequences.sql > flyway/sql/V1__create_all_sequences.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/create_all_tables.sql 	> flyway/sql/V2__create_all_tables.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/create_all_index.sql 	> flyway/sql/V3__create_all_index.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/insert_departure.sql 	> flyway/sql/V4__insert_departure.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/insert_arrival.sql 	> flyway/sql/V5__insert_arrival.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/insert_accommodation.sql > flyway/sql/V6__insert_accommodation.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/insert_age.sql 		> flyway/sql/V7__insert_age.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/insert_employee.sql 	> flyway/sql/V8__insert_employee.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/insert_customer.sql 	> flyway/sql/V9__insert_customer.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/insert_tourinfo.sql 	> flyway/sql/V10__insert_tourinfo.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/insert_tourcon.sql 	> flyway/sql/V11__insert_tourcon.sql
iconv -f SHIFT_JISX0213 -t UTF-8 sqls/postgres/insert_reserve.sql 	> flyway/sql/V12__insert_reserve.sql
```

### Procfileã®ä½œæˆ

Tomcatèµ·å‹•å‰ã«Flywayã®å®Ÿè¡Œã‚„ã€`META-INF/context.xml`ã«è¨­å®šã•ã‚Œã¦ã„ã‚‹JNDIã®è¨­å®šã‚’æ›¸ãæ›ãˆãŸã„ã®ã§ã€
[`Procfile`](https://paketo.io/docs/howto/configuration/#procfiles) ã‚’ä½¿ç”¨ã—ã¦ã€ä»»æ„ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§èµ·å‹•ã§ãã‚‹ã‚ˆã†ã«ã—ã¾ã™ã€‚

```
cat <<EOF > Procfile
web: bash /workspace/run.sh
EOF
```

èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯`run.sh`ã«è¨˜è¿°ã—ã¾ã™ã€‚

ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹(PostgreSQL)ã¸ã®æ¥ç¶šæƒ…å ±ã¯ [Service Binding](https://github.com/servicebinding/spec) ã§æ¸¡ã•ã‚Œã‚‹ã‚‚ã®ã¨ã—ã¾ã™ã€‚
[Well-known Secret Entries](https://github.com/servicebinding/spec#well-known-secret-entries) ã®ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãŒä½¿ç”¨ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã«ã—ã¾ã™ã€‚

```
cat <<'EOD' > run.sh
#!/bin/bash
set -e

BINDING_NAME=tour-db
DATABASE_HOST=$(cat ${SERVICE_BINDING_ROOT}/${BINDING_NAME}/host)
DATABASE_PORT=$(cat ${SERVICE_BINDING_ROOT}/${BINDING_NAME}/port)
DATABASE_USERNAME=$(cat ${SERVICE_BINDING_ROOT}/${BINDING_NAME}/username)
DATABASE_PASSWORD=$(cat ${SERVICE_BINDING_ROOT}/${BINDING_NAME}/password)
DATABASE_NAME=$(cat ${SERVICE_BINDING_ROOT}/${BINDING_NAME}/database)
DATABASE_URL="jdbc:postgresql://${DATABASE_HOST}:${DATABASE_PORT}/${DATABASE_NAME}"

cat << EOF > ./META-INF/context.xml
<Context>
  <Resource
     name="jdbc/terasolunaTourDataSource"
     type="javax.sql.DataSource"
     driverClassName="org.postgresql.Driver"
     password="${DATABASE_PASSWORD}"
     maxIdle="4"
     maxWait="5000"
     username="${DATABASE_USERNAME}"
     url="${DATABASE_URL}"
     maxActive="20"/>
</Context>
EOF

${JAVA_HOME}/bin/java \
  -cp `ls WEB-INF/lib/postgresql-*.jar`:./flyway/lib/community/* \
  org.flywaydb.commandline.Main migrate \
  -url=${DATABASE_URL} \
  -user=${DATABASE_USERNAME} \
  -password=${DATABASE_PASSWORD}

export CATALINA_OUT=/dev/stdout
export CATALINA_PID=/tmp/catalina.pid
bash ${CATALINA_HOME}/bin/catalina.sh start

JAVA_PID=$(cat $CATALINA_PID)

stop_java_app() {
    kill -SIGTERM $JAVA_PID
}

trap stop_java_app SIGINT
while [ -e /proc/$JAVA_PID ]
do
    sleep 1
done
EOD
chmod +x run.sh
```

### warã®æ›´æ–°

ãƒ“ãƒ«ãƒ‰ã—ãŸwarã«flywayã‚„Procfileãªã©ã‚’è©°ã‚è¾¼ã¿ã¾ã™ã€‚ã¾ãŸã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã«PostgreSQLã®JDBCãƒ‰ãƒ©ã‚¤ãƒãƒ¼ãŒå«ã¾ã‚Œã¦ã„ãªã„ã®ã§ã€ãƒ‰ãƒ©ã‚¤ãƒãƒ¼ã‚‚ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦è©°ã‚è¾¼ã¿ã¾ã™ã€‚


```
mkdir -P WEB-INF/lib
wget https://repo1.maven.org/maven2/org/postgresql/postgresql/42.3.6/postgresql-42.3.6.jar -P WEB-INF/lib
cp /opt/apache-tomcat-9.0.84/webapps/ROOT.war ./
```

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ `ROOT.war` ã«ãƒ•ã‚¡ã‚¤ãƒ«ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```
jar -uvf ROOT.war flyway/lib flyway/jars flyway/sql WEB-INF Procfile run.sh
```

### pack CLIã§ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ãƒ“ãƒ«ãƒ‰

TAPã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹å‰ã« [`pack`](https://github.com/buildpacks/pack) CLIã§ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ã—ã¦ãƒ­ãƒ¼ã‚«ãƒ«ã§èµ·å‹•ç¢ºèªã—ã¾ã™ã€‚

```
pack build toursample --builder paketobuildpacks/builder-jammy-base:latest --path ./ROOT.war -e BP_JVM_VERSION=8
```

### ãƒ©ãƒƒãƒ—ãƒˆãƒƒãƒ—ä¸Šã®Dockerã§èµ·å‹•

ãƒ“ãƒ«ãƒ‰ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’Dockerã§èµ·å‹•ã—ã¦ã¿ã¾ã™ã€‚
ãã®å‰ã«PostgreSQLã‚’èµ·å‹•ã—ã¾ã™ã€‚

```
docker run --rm \
 -p 5432:5432 \
 -e POSTGRES_DB=tour \
 -e POSTGRES_USER=tour \
 -e POSTGRES_PASSWORD=tour \
 bitnami/postgresql:14
```

[Service Binding](https://paketo.io/docs/howto/configuration/#bindings) ç”¨ã®ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ»ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```
mkdir -p bindings/tour-db
echo postgresql > bindings/tour-db/type
echo host.docker.internal > bindings/tour-db/host
echo 5432 > bindings/tour-db/port
echo tour > bindings/tour-db/username
echo tour > bindings/tour-db/password
echo tour > bindings/tour-db/database
```

ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¾ã™ã€‚

```
docker run --rm \
  --name toursample \
  -p 8080:8080 \
  -v ${PWD}/bindings:/bindings \
  -e SERVICE_BINDING_ROOT=/bindings \
  -m 768m \
  toursample
```

http://localhost:8080 ã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹ã¨ãƒˆãƒƒãƒ—ç”»é¢ã«é·ç§»ã—ã¾ã™ã€‚

<img width="1024" alt="image" src="https://user-images.githubusercontent.com/106908/171448958-57858932-49aa-4dc6-a708-7d71727c8f92.png">

ä¼šå“¡ID `00000001`, ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ `password` ã§ãƒ­ã‚°ã‚¤ãƒ³ã§ãã¾ã™ã€‚

<img width="1024" alt="image" src="https://user-images.githubusercontent.com/106908/171449055-017bb7c5-8512-4587-80f1-11e5121bf7a9.png">

ã‚¢ãƒ—ãƒªã¨PostgreSQLã‚’Ctrl+Cã§çµ‚äº†ã—ã¦ãã ã•ã„ã€‚

### TAPã«ãƒ‡ãƒ—ãƒ­ã‚¤

ã„ã‚ˆã„ã‚ˆTAPã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

ãã®å‰ã«PostgreSQLã‚’ç”¨æ„ã—ã¾ã™ã€‚ã“ã“ã§ã¯Bitnami Serviceã‚’ä½¿ç”¨ã—ã¾ã™ã€‚ æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§PostgreSQLã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚

```
tanzu service class-claim create tour-db --class postgresql-unmanaged --parameter storageGB=1 -n demo
```

æ¬¡ã®ã‚ˆã†ãªçŠ¶æ…‹ã«ãªã‚‹ã¾ã§å¾…ã¡ã¾ã™ã€‚

```
$ tanzu services class-claims get tour-db --namespace demo
Name: tour-db
Namespace: demo
Claim Reference: services.apps.tanzu.vmware.com/v1alpha1:ClassClaim:tour-db
Class Reference: 
  Name: postgresql-unmanaged
Parameters: 
  storageGB: 1
Status: 
  Ready: True
  Claimed Resource: 
    Name: e18f1e5a-6533-449c-b0ea-5cb4317f4c07
    Namespace: demo
    Group: 
    Version: v1
    Kind: Secret
```

ã„ã‚ˆã„ã‚ˆãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

```
tanzu apps workload apply toursample \
  --app toursample \
  --local-path ./ROOT.war \
  --type web \
  --build-env BP_JVM_VERSION=8 \
  --annotation autoscaling.knative.dev/minScale=1 \
  --service-ref tour-db=services.apps.tanzu.vmware.com/v1alpha1:ClassClaim:tour-db \
  -n demo \
  -y
```

> â„¹ï¸ testingã‚’å«ã‚€Supply Chainã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹å ´åˆã¯ã€`--label apps.tanzu.vmware.com/has-tests=true` ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚

> â„¹ï¸ Local Source Proxyã‚’ä½¿ç”¨ã—ãªã„å ´åˆã¯ã€ `--source-image` ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã§ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã‚³ãƒ³ãƒ†ãƒŠãƒ¬ã‚¸ã‚¹ãƒˆãƒªã®ãƒ¬ãƒã‚¸ãƒˆãƒªåã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚


é€²æ—ã¯æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ç¢ºèªã§ãã¾ã™ã€‚

```
tanzu apps workload tail -n demo toursample --since 5m
```

ã—ã°ã‚‰ãã™ã‚‹ã¨ãƒ‡ãƒ—ãƒ­ã‚¤ãŒå®Œäº†ã—ã¾ã™ã€‚

```
$ tanzu apps workload get -n demo toursample
ğŸ“¡ Overview
   name:        toursample
   type:        web
   namespace:   demo

ğŸ’¾ Source
   type:    source image
   image:   532912407632.dkr.ecr.ap-northeast-1.amazonaws.com/tap-lsp:demo-toursample@sha256:52e10a5ab3777384d104402dec839bc9017e53b8ae961fb0aa2a867e637a975b

ğŸ“¦ Supply Chain
   name:   source-test-scan-to-url

   NAME               READY   HEALTHY   UPDATED   RESOURCE
   source-provider    True    True      7m15s     imagerepositories.source.apps.tanzu.vmware.com/toursample
   source-tester      True    True      6m37s     runnables.carto.run/toursample
   image-provider     True    True      5m45s     images.kpack.io/toursample
   image-scanner      True    True      5m14s     imagescans.scanning.apps.tanzu.vmware.com/toursample
   config-provider    True    True      5m11s     podintents.conventions.carto.run/toursample
   app-config         True    True      5m11s     configmaps/toursample
   service-bindings   True    True      5m11s     configmaps/toursample-with-claims
   api-descriptors    True    True      5m11s     configmaps/toursample-with-api-descriptors
   config-writer      True    True      5m3s      taskruns.tekton.dev/toursample-config-writer-4t7rp

ğŸšš Delivery
   name:   delivery-basic

   NAME              READY   HEALTHY   UPDATED   RESOURCE
   source-provider   True    True      4m11s     imagerepositories.source.apps.tanzu.vmware.com/toursample-delivery
   deployer          True    True      3m17s     apps.kappctrl.k14s.io/toursample

ğŸ’¬ Messages
   No messages found.

ğŸ” Services
   CLAIM     NAME      KIND         API VERSION
   tour-db   tour-db   ClassClaim   services.apps.tanzu.vmware.com/v1alpha1

ğŸ›¶ Pods
   NAME                                           READY   STATUS      RESTARTS   AGE
   scan-toursample-5w5tv-pod                      0/6     Completed   0          5m45s
   toursample-00001-deployment-5d955b64b6-bdfn9   2/2     Running     0          4m9s
   toursample-build-1-build-pod                   0/1     Completed   0          6m37s
   toursample-config-writer-4t7rp-pod             0/1     Completed   0          5m10s
   toursample-jlsmz-test-pod                      0/1     Completed   0          6m59s

ğŸš¢ Knative Services
   NAME         READY   URL
   toursample   Ready   https://toursample.demo.tap.57.180.147.144.sslip.io

To see logs: "tanzu apps workload tail toursample --namespace demo --timestamp --since 1h"
```

URLã«ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚Œã°ã€ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

<img width="1024" alt="image" src="https://user-images.githubusercontent.com/106908/171548275-93d36ac1-198d-4293-a92d-2dbe557a9d1d.png">

ãƒ­ã‚°ã‚¤ãƒ³ã‚‚ã§ãã¾ã™ã€‚

<img width="1024" alt="image" src="https://user-images.githubusercontent.com/106908/171548341-131a0166-fe37-4853-b43e-b046f76e048b.png">


### ã‚¢ãƒ—ãƒªã®å‰Šé™¤

```
tanzu apps workload delete -n demo toursample -y
tanzu service class-claim delete tour-db -n demo
```