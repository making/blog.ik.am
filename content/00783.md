---
title: Honoã‚¢ãƒ—ãƒªã‚’Tanzu Application Platformã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ãƒ¡ãƒ¢
tags: ["Kubernetes", "Tanzu", "TAP", "Hono", "Node.js", "TypeScript"]
categories: ["Dev", "CaaS", "Kubernetes", "TAP"]
---


[Hono](https://hono.dev)ã‚¢ãƒ—ãƒªã‚’[Tanzu Application Platform](https://tanzu.vmware.com/application-platform)ã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã¿ã¾ã™ã€‚

TAPç’°å¢ƒã¨ã—ã¦ã¯ç„¡å„Ÿã§ä½¿ãˆã‚‹[Developer Sandbox](https://tanzu.academy/guides/developer-sandbox)ã‚’ä½¿ç”¨ã—ã¾ã—ãŸã€‚

Buildpackã§ã‚³ãƒ³ãƒ†ãƒŠã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ãŸã„ã®ã§ã€Runtimeã¨ã—ã¦ã¯Node.jsã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```
npm create hono@latest hello-hono
```

templateã«nodejsã‚’é¸æŠã—ã¾ã™ã€‚

```
create-hono version 0.3.2
âœ” Using target directory â€¦ hello-hono
âœ” Which template do you want to use? â€º nodejs
cloned honojs/starter#main to /Users/tmaki/git/hello-hono
âœ” Copied project files
```

ã¾ãšã¯é–‹ç™ºãƒ¢ãƒ¼ãƒ‰ã§èµ·å‹•ã—ã¾ã™ã€‚

```
cd hello-hono
npm install
npm run dev
```

ã‚¢ãƒ—ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚

```
$ curl localhost:3000
Hello Hono!
```

serverãŒlistenã™ã‚‹ãƒãƒ¼ãƒˆã‚’ç’°å¢ƒå¤‰æ•°`PORT`ã‚’ä½¿ã£ã¦å¤‰ãˆã‚‰ã‚Œã‚‹ã‚ˆã†ã«`src/index.ts`ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã™ã€‚

```js
const port = process.env.PORT ? Number(process.env.PORT) : 3000
```

templateã®`package.json`ã«ã¯ã‚ã¾ã‚Šè¨­å®šãŒãªã„ã®ã§ã€å°‘ã—è¿½è¨˜ã—ã¾ã™ã€‚

```
$ cat package.json 
{
  "scripts": {
    "dev": "tsx watch src/index.ts"
  },
  "dependencies": {
    "@hono/node-server": "^1.4.1",
    "hono": "^3.12.6"
  },
  "devDependencies": {
    "tsx": "^3.12.2"
  }
}
```

```
npm install typescript @types/node --save-dev
```

`scripts`ã«ä»¥ä¸‹ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```
  "scripts": {
    "dev": "tsx watch src/index.ts",
    "build": "tsc",
    "start": "node dist/index.js"
  },
```

ä»¥ä¸‹ã€`tsconfig.json`ã«`target`ã€`module`ã€`outDir`ã‚’è¨­å®šã—ã¾ã™ã€‚

```
{
  "compilerOptions": {
    "strict": true,
    "jsx": "react-jsx",
    "jsxImportSource": "hono/jsx",
    "target": "es2015",
    "module": "commonjs",
    "outDir": "./dist"
  }
}
```

`.gitignore`ã«`dist`ã‚’è¿½åŠ ã—ã¾ã™ã€‚

```
echo dist >> .gitignore
```


ã“ã‚Œã§æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ“ãƒ«ãƒ‰ã¨ã‚¢ãƒ—ãƒªã®èµ·å‹•ã‚’è¡Œã„ã¾ã™ã€‚

```
npm run build
PORT=8080 npm run start
```

æ¬¡ã®ãƒ­ã‚°ãŒæµã‚Œã¾ã™ã€‚

```
> build
> tsc


> start
> node dist/index.js

Server is running on port 8080
```

ã‚¢ãƒ—ãƒªã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚

```
$ curl localhost:8080
Hello Hono!
```

ã“ã“ã¾ã§ã§ãã‚Œã°TAP readyã§ã™ã€‚TAPã«ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

Local Source Proxyã‚’ä½¿ç”¨ã—ã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‹ã‚‰ã‚¢ãƒ—ãƒªã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

TAPã«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰é™¤å¤–ã™ã‚‹ãƒªã‚¹ãƒˆã‚’`.tanzuignore`ã«ä½œæˆã§ãã¾ã™ã€‚`.gitignore`ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚

```
cp .gitignore .tanzuignore
```

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¾ã™ã€‚

```
tanzu apps workload apply hello-hono \
  -n apps \
  --app hello-hono \
  --local-path . \
  --type web \
  --yes
```

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ­ã‚°ã‚’ç¢ºèªã—ã¾ã™ã€‚

```
tanzu apps workload tail hello-hono --namespace apps --timestamp --since 1h
```

æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§çŠ¶æ…‹ã‚’ç¢ºèªã§ãã¾ã™ã€‚`Knative Services`ã®URLãŒè¡¨ç¤ºã•ã‚Œã€`Ready`ã«ãªã‚Œã°URLã«ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½ã§ã™ã€‚

```
$ tanzu apps workload get hello-hono --namespace apps                 
ğŸ“¡ Overview
   name:        hello-hono
   type:        web
   namespace:   apps

ğŸ’¾ Source
   type:    source image
   image:   us-central1-docker.pkg.dev/tap-sandbox-dev/tapv-willing-ladybird/lsp:apps-hello-hono@sha256:14557ab9cfa5a6990b0ab25f88210c74693a5c26fe30476f591f73a3cb4d7214

ğŸ“¦ Supply Chain
   name:   source-to-url

   NAME               READY   HEALTHY   UPDATED   RESOURCE
   source-provider    True    True      7m19s     imagerepositories.source.apps.tanzu.vmware.com/hello-hono
   image-provider     True    True      5m51s     images.kpack.io/hello-hono
   config-provider    True    True      5m47s     podintents.conventions.carto.run/hello-hono
   app-config         True    True      5m47s     configmaps/hello-hono
   service-bindings   True    True      5m47s     configmaps/hello-hono-with-claims
   api-descriptors    True    True      5m47s     configmaps/hello-hono-with-api-descriptors
   config-writer      True    True      5m39s     taskruns.tekton.dev/hello-hono-config-writer-hrhsc

ğŸšš Delivery
   name:   delivery-basic

   NAME              READY   HEALTHY   UPDATED   RESOURCE
   source-provider   True    True      5m14s     imagerepositories.source.apps.tanzu.vmware.com/hello-hono-delivery
   deployer          True    True      5m7s      apps.kappctrl.k14s.io/hello-hono

ğŸ’¬ Messages
   No messages found.

ğŸ›¶ Pods
   NAME                                           READY   STATUS      RESTARTS   AGE
   hello-hono-00001-deployment-8556dcd768-k2n8n   2/2     Running     0          26s
   hello-hono-build-1-build-pod                   0/1     Completed   0          7m19s
   hello-hono-config-writer-hrhsc-pod             0/1     Completed   0          5m47s

ğŸš¢ Knative Services
   NAME         READY   URL
   hello-hono   Ready   https://hello-hono-apps.tapv-willing-ladybird.tapsandbox.com

To see logs: "tanzu apps workload tail hello-hono --namespace apps --timestamp --since 1h"
```


```
$ curl https://hello-hono-apps.tapv-willing-ladybird.tapsandbox.com
Hello Hono!
```

ã“ã“ã¾ã§ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ https://github.com/making/hello-hono ã«ç½®ãã¾ã—ãŸã€‚

Gitã‹ã‚‰ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹å ´åˆã¯ã€æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã§ã§ãã¾ã™ã€‚

```
tanzu apps workload apply hello-hono \
  -n apps \
  --app hello-hono \
  --git-repo https://github.com/making/hello-hono \
  --git-branch main \
  --type web
```